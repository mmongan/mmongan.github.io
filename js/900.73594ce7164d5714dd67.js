"use strict";(self.webpackChunkbabylonjs_typescript_webpack_template=self.webpackChunkbabylonjs_typescript_webpack_template||[]).push([[900],{9900:(e,n,a)=>{a.r(n),a.d(n,{Dispose:()=>u,DumpData:()=>d,DumpDataAsync:()=>l,DumpFramebuffer:()=>c,DumpTools:()=>f});var r=a(3155),t=a(66),s=a(9111),p=a(9583);let i,o=null;async function c(e,n,a,r,t="image/png",s,p){const i=await a.readPixels(0,0,e,n);d(e,n,new Uint8Array(i.buffer),r,t,s,!0,void 0,p)}function l(e,n,a,r="image/png",t,s=!1,p=!1,i){return new Promise((o=>{d(e,n,a,(e=>o(e)),r,t,s,p,i)}))}function d(e,n,c,l,d="image/png",f,m=!1,h=!1,w){(async function(){return o||(o=new Promise(((e,n)=>{let t,s=null;const o={preserveDrawingBuffer:!0,depth:!1,stencil:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1};Promise.resolve().then(a.bind(a,1371)).then((({ThinEngine:c})=>{const l=p.q.Instances.length;try{t=new OffscreenCanvas(100,100),s=new c(t,!1,o)}catch(e){l<p.q.Instances.length&&p.q.Instances.pop()?.dispose(),t=document.createElement("canvas"),s=new c(t,!1,o)}p.q.Instances.pop(),p.q.OnEnginesDisposedObservable.add((e=>{s&&e!==s&&!s.isDisposed&&0===p.q.Instances.length&&u()})),s.getCaps().parallelShaderCompile=void 0;const d=new r.J(s);a.e(752).then(a.bind(a,8752)).then((({passPixelShader:a})=>{if(!s)return void n("Engine is not defined");const p=new r.$({engine:s,name:a.name,fragmentShader:a.shader,samplerNames:["textureSampler"]});i={canvas:t,engine:s,renderer:d,wrapper:p},e(i)}))})).catch(n)}))),await o})().then((a=>{if(a.engine.setSize(e,n,!0),c instanceof Float32Array){const e=new Uint8Array(c.length);let n=c.length;for(;n--;){const a=c[n];e[n]=Math.round(255*(0,s.OQ)(a))}c=e}const r=a.engine.createRawTexture(c,e,n,5,!1,!m,1);a.renderer.setViewport(),a.renderer.applyEffectWrapper(a.wrapper),a.wrapper.effect._bindTexture("textureSampler",r),a.renderer.draw(),h?t.S0.ToBlob(a.canvas,(e=>{const n=new FileReader;n.onload=e=>{const n=e.target.result;l&&l(n)},n.readAsArrayBuffer(e)}),d,w):t.S0.EncodeScreenshotCanvasData(a.canvas,l,d,f,w),r.dispose()}))}function u(){i?(i.wrapper.dispose(),i.renderer.dispose(),i.engine.dispose()):o?.then((e=>{e.wrapper.dispose(),e.renderer.dispose(),e.engine.dispose()})),o=null,i=null}const f={DumpData:d,DumpDataAsync:l,DumpFramebuffer:c,Dispose:u};t.S0.DumpData=d,t.S0.DumpDataAsync=l,t.S0.DumpFramebuffer=c}}]);
//# sourceMappingURL=900.73594ce7164d5714dd67.js.map